<html lang="zh">
<head>
    <meta charset="utf-8">
    <title>橙办 - 资讯详情</title>
    <link rel="stylesheet" type="text/css" href="css/all.css"/>
    <link rel="stylesheet" type="text/css" href="css/newsDetail.css"/>
    <script src="js/utils.js" type="text/javascript" charset="utf-8"></script>
    <script src="js/jquery-1.12.0.min.js" type="text/javascript" charset="utf-8"></script>
</head>

<!-- 美洽客服 -->
<script title="text/javascript">
    (function (m, ei, q, i, a, j, s) {
        m[i] = m[i] || function () {
            (m[i].a = m[i].a || []).push(arguments)
        };
        j = ei.createElement(q);
        s = ei.getElementsByTagName(q)[0];
        j.async = true;
        j.charset = 'UTF-8';
        j.src = 'https://static.meiqia.com/dist/meiqia.js?=_t';
        s.parentNode.insertBefore(j, s);
    })(window, document, 'script', '_MEIQIA');
    _MEIQIA('entId', 51778);
</script>

<script type="text/javascript">
    let filter = {};
    window.onload = function () {

        getFilterList();
        getHotList();
        let request = window.location.search;
        let newsId = http.getParameter(request, "news_id");
        getNewsDetail(newsId);
    };

    function getFilterList() {
        http.post({
            url: "filter/newsTag",
            params: {
                news_tag_id: filter.checkedNewsTagId
            },
            success: function (data) {
                filter = data;
                setNewsType(data.newsTagList);
            }
        })
    }

    function getNewsDetail(id) {

        http.post({
            url: "news/news",
            params: {
                id: id,
            },
            success: function (data) {
                setNewsContent(data);
            }
        });
    }

    /**
     * 设置类型
     * @param typeList
     */
    function setNewsType(typeList) {
        if (typeList == null) return;
        let newTypeBox = document.getElementById("news_type");
        for (let i = 0, len = typeList.length; i < len; i++) {
            let typeItem = document.createElement("div");
            typeItem.setAttribute("class", "link");
            typeItem.onclick = function () {
                window.location.href = "news.html?news_tag_id=" + typeList[i].id;
            };
            typeItem.innerHTML = typeList[i].name;
            newTypeBox.appendChild(typeItem);
        }
    }

    function setNewsContent(newsBean) {
        let newsTitle = document.getElementById("news_detail_title");
        newsTitle.innerHTML = newsBean.title;
        let newsTime = document.getElementById("news_time");
        newsTime.innerHTML = newsBean.last_edit_time;
        let newsContent = document.getElementById("news_content");
        newsContent.innerHTML = newsBean.content;

        let notesStr = newsBean.notes;
        if (notesStr) {
            let notes = JSON.parse(notesStr);
            let keywordListStr = notes.keyword_list;
            if (keywordListStr) {
                let keywordList = JSON.parse(keywordListStr);
                if (keywordList) {
                    let newsKeyword = document.getElementById("news_keyword");
                    for (let i = 0, len = keywordList.length; i < len; i++) {
                        let newKey = document.createElement("span");
                        newKey.className = "keyword_item";
                        newKey.innerHTML = keywordList[i];
                        newsKeyword.appendChild(newKey);
                    }
                }
            }
        }
    }

    function getHotList() {
        http.post({
            url: "news/hot",
            success: function (data) {
                setHeatNews(data);
            }
        })
    }

    /**
     * 设置资讯
     * @param heatNewsList
     */
    function setHeatNews(heatNewsList) {
        if (heatNewsList == null) return;
        let ListBox = document.getElementById("right_heat_news");
        for (let i = 0, len = heatNewsList.length; i < len; i++) {
            let itemBox = document.createElement("div");
            itemBox.className = "right_heat_news_item";

            let imgListStr = heatNewsList[i].img_list;
            let imgList = JSON.parse(imgListStr);
            let itemImg = document.createElement("img");
            itemImg.className = "right_heat_news_img";
            if (imgList && imgList.length > 0) {
                utils.setImageSrc(itemImg, imgList[0]);
            } else {
                utils.setImageSrc(itemImg, null);
            }
            itemBox.appendChild(itemImg);

            let itemInfo = document.createElement("div");
            itemInfo.className = "right_heat_news flex_column_left";

            let itemTitle = document.createElement("div");
            itemTitle.className = "right_heat_news_title";
            itemTitle.innerHTML = heatNewsList[i].title;
            itemTitle.onclick = function () {
                window.open("newsDetail.html?news_id=" + heatNewsList[i].id);
            };
            itemInfo.appendChild(itemTitle);

            let itemTime = document.createElement("div");
            itemTime.className = "right_heat_news_time";
            itemTime.innerHTML = heatNewsList[i].last_edit_time;
            itemInfo.appendChild(itemTime);

            if (i === len - 1) {
                itemBox.setAttribute("style", "border: none;");
            }

            itemBox.appendChild(itemInfo);
            ListBox.appendChild(itemBox);
        }
    }

</script>

<body>
<div class="title_box">
    <div class="win flex_row position_relative">
        <div class="top_logo"></div>
        <div class="position_right">
            <div class="title_text_right">
                <a href="index.html" class="clickable">首页</a>
            </div>
            <div class="title_text_right title_obvious">
                <a href="search.html" class="clickable">写字楼出租</a>
            </div>
            <div class="title_text_right">
                <a href="search.html?type_id=3" class="clickable">共享办公</a>
            </div>
            <div class="title_text_right">
                <a href="news.html" class="clickable">资讯中心</a>
            </div>
        </div>
    </div>
</div>

<div class="bg_white">
    <div class="win top_box flex_row">
        <div class="flex_row" id="news_type">
        </div>
    </div>
</div>

<div class="flex_row matop win content_box">
    <div class="content_right_box" id="news_detail">
        <h3 class="news_detail_title" id="news_detail_title"></h3>
        <hr/>
        <div class="news_time" id="news_time"></div>
        <div class="news_content" id="news_content"></div>
        <div id="news_keyword" class="news_keyword">
        </div>
    </div>
    <div class="content_right bg_white">
        <form action="search.html">
            <div class="right_search_box">
                <input type="text" id="keyword_input" class="right_search" name="keyword" placeholder="在这里输入您想了解的写字楼"/>
                <input class="right_search_btn" type="submit" value=" "/>
            </div>
        </form>

        <!--        <div class="right_item_box">-->
        <!--            <div class="right_item_title_red">热门写字楼</div>-->
        <!--            <div class="flex_column_left" id="right_heat_building">-->
        <!--            </div>-->
        <!--        </div>-->

        <div class="right_item_box">
            <div class="right_item_title_green">近期资讯</div>
            <div class="flex_column_left" id="right_heat_news">
            </div>
        </div>
    </div>
</div>

<div class="win hot_zone_sign flex_column_left">
    <h3 class="item_title">热门区域</h3>
    <div class="hot_zone_line"></div>
    <div class="flex_row_left">
        <a class="hot_zone_value" href="search.html?district_id=2">浦东办公室</a>
        <a class="hot_zone_value" href="search.html?district_id=3">黄浦办公室</a>
    </div>
</div>

<div class="win hot_building_sign flex_column_left">
    <h3 class="item_title">热门写字楼</h3>
    <div class="hot_building_line"></div>
    <div class="flex_row_left">
        <a class="hot_building_value" href="search.html?district_id=2">浦东办公室</a>
        <a class="hot_building_value" href="search.html?district_id=3">黄浦办公室</a>
    </div>
</div>

<div class="bottom_box flex_column_left">
    <div class="win flex_column_left">
        <span class="friendly_href_sign">&nbsp;|&nbsp;&nbsp;&nbsp;友情链接</span>
        <div class="friendly_href">
            <a href="https://sh.diandianzu.com/" target="_blank">上海办公室出租</a>
            <a href="https://sh.diandianzu.com/" target="_blank">上海办公室出租</a>
            <a href="https://sh.diandianzu.com/" target="_blank">上海办公室出租</a>
        </div>
    </div>

    <div class="foot_logo flex_row">
        <img src="img/logo_dark.png" alt="橙办"/>
        <span>&nbsp;&nbsp;&nbsp;找办公室 就上橙办！</span>
    </div>

    <div class="foot_contact_info flex_column_left">
        <span>电话：021 - 5090 6123</span>
        <span>邮箱：000000@qq.com</span>
        <span>邮编：000000</span>
    </div>
</div>
</body>
</html>
